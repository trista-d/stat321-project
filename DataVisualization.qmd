---
title: "Data Visualization Final Project"
author: "Karen Nickel"
format: html
editor: visual
---

## Data Visualization Comments/Criteria

8\. Can we use R packages like ggplot2 or plotly for visualization?\
➢ Yes! You are free to use any R packages we discussed in class. Just make sure you\
cite the package in the references.

\
9. How many visualizations are required?\
➢ There is no fixed number, but you should create at least 3-5 visualizations that help\
explain your dataset and analysis.

\
10. Do we need interactive visualizations?\
➢ Interactive visualizations are optional, but they can enhance your project and\
improve your presentation score.

## Import and Read Dataset - must redo for the final cleaned version

```{r}
library(readr)
cleaned_nfl_data <- read_csv("final_clean_nfl.csv")
View(cleaned_nfl_data)
```

## Visualizations: Performance vs. Salary

**Big plays: Touchdowns vs. Salary**

-   **scatter for all**

-   **bar chart for top 10 and bottom 10**

**Consistency: Yards vs. Salary**

-   **scatter for all**

-   **bar chart for top 10 and bottom 10**

**Plot 1: Histogram: Salary distribution among receivers.**

**Plots 2 and 3: If yards by salary more important for scatter, do bar chart for the touchdowns.**

-   **do one or the other; one of each.**

Plot 4: Heat map (use tableau). because everything should connect back to salary.

-   this will use catch rate in it, and the 20-39 and 40+ columns, compared to salary as the colours.

Plot 5: Dashboard to support conclusions. So and so was the best of the season.

-   will pull the top plays from youtube and link them.

-   This will be a table with highlighted stuff and plays attached.

-   Will decide which players to put in the table/dashboard in based on figure results/regression results.

#### Setup:

##### Importing final cleaned data under name "final_clean_nfl".

```{r}
library(readr)
final_clean_nfl <- read_csv("final_clean_nfl.csv")
View(final_clean_nfl)
```

#### Plot 1: histogram of Salary

##### UI:

```{r}
library(ggplot2)

ui_salary <- fluidPage(
  titlePanel("Salary Histogram"),
  sidebarLayout(
    sidebarPanel(
      sliderInput("bins",
                  "Number of Bins:",
                  min= 5,
                  max= 50,
                  value= 10) #Default is 10bins

      ),
    mainPanel(
      plotOutput("histPlot") #Output placeholder for the histogram
      ) 
    )
  )
```

##### Server:

```{r}
server_salary <- function(input,output){
  output$histPlot <- renderPlot({      # use the Salary data from dataset
    salary_data <- final_clean_nfl$Salary
 #Create the histogram with user-defined bins
 ggplot(data = data.frame(x = salary_data), aes(x = final_clean_nfl$Salary)) +
   geom_histogram(bins = input$bins, fill = '#009E73', color = "white") + 
   # green for $$
  theme_minimal() +
   labs(
     title = "Histogram of NFL Receiver 2024 Salaries",
     x = "Salary ($)",
     y = "Frequency"
     )
  })
}
```

##### Running the app:

```{r, eval = FALSE}
shinyApp(ui = ui_salary, server = server_salary)
```

From the histogram, we can see that the 2024 salaries of NFL recievers is heavily right skewed, with several extreme outliers with very high salaries.

The untransformed salaries were plotted on the x axis in order to accurately visualize just how much higher the outlier salaries are, since plotting the log10 or square root transformed salaries may distort our understanding of the data.

#### Log transformation version: 

##### UI: 

```{r}
library(ggplot2)

ui_salary <- fluidPage(
  titlePanel("Salary Histogram"),
  sidebarLayout(
    sidebarPanel(
      sliderInput("bins",
                  "Number of Bins:",
                  min= 5,
                  max= 50,
                  value= 10) #Default is 10bins

      ),
    mainPanel(
      plotOutput("histPlot") #Output placeholder for the histogram
      ) 
    )
  )
```

##### Server:

```{r}
server_salary <- function(input,output){
  output$histPlot <- renderPlot({      # use the Salary data from dataset
    salary_data <- log10(final_clean_nfl$Salary)
 #Create the histogram with user-defined bins
 ggplot(data = data.frame(x = salary_data), aes(x = final_clean_nfl$Salary)) +
   geom_histogram(bins = input$bins, fill = '#009E73', color = "white") +
   scale_x_log10() +
  theme_minimal() +
   labs(
     title = "Histogram of NFL Receiver 2024 Salaries",
     x = "log(Salary ($))",
     y = "Frequency"
     )
  })
}
```

##### Running the app:

```{r}
shinyApp(ui = ui_salary, server = server_salary)
```

#### Plot 2: Scatter plots of Salary as as function of Touchdowns or Yards

##### Salary as a function of Touchdowns:

```{r}
ggplot(final_clean_nfl, aes(x = TD, y = Salary)) +
  geom_point(size = 3, color = '#D55E00') +   # size is for size of the points
  labs(title = "Salary vs. Touchdowns",
       x = "Number of Touchdowns",
       y = "2024 Salary ($)") +
  # add a verticle line at the median TD
  geom_line(aes(x = median(final_clean_nfl$TD)), color = "grey") +
  theme_minimal() +
  # label the players with highest salaries and highest number of touchdowns
  geom_text(label = ifelse(final_clean_nfl$Salary > 12500000, final_clean_nfl$Player, ''), vjust = 1.4) +
  geom_text(label = ifelse(final_clean_nfl$TD > 15, final_clean_nfl$Player, ''), hjust = 0.7, vjust = -1) +
  geom_text(label = ifelse(final_clean_nfl$TD > 11 & final_clean_nfl$TD < 13, final_clean_nfl$Player, ''), vjust = -1) +
  annotate("text", label = "Median TD", x = median(final_clean_nfl$TD), y = 22500000, color = "grey")
```

There is no obvious trend between the total touchdowns made and a player's salary in 2024. However, it does appear that the players receiving the highest salaries are making more than the median number of touchdowns. That being said, the players making some of the highest numbers of touchdowns are not receiving very high salaries.

The median was represented rather than the mean because the TD variable is skewed and has outliers.

##### Salary as a function of Yards:

Used this site <https://stackoverflow.com/questions/15624656/label-points-in-geom-point> to add labels to specific points on the plot.

```{r}
ggplot(final_clean_nfl, aes(x = Yds, y = Salary)) +
  geom_point(size = 3, color = '#56B4E9') +   # size is for size of the points
  labs(title = "Salary vs. Yards",
       x = "Yards travelled with ball",
       y = "2024 Salary ($)") +
  # add a vertical line at the median Yds
  geom_line(aes(x = median(final_clean_nfl$Yds)), color = "grey") +
  theme_minimal() +
  # highlight some of the highest salaries and some of the highest yards travelled
  geom_text(label = ifelse(final_clean_nfl$Salary > 12500000, final_clean_nfl$Player, ''), vjust = 1.4) +
  geom_text(label = ifelse(final_clean_nfl$Yds > 1600, final_clean_nfl$Player, ''), hjust = 0.7, vjust = 1.2) +
  geom_text(label = ifelse(final_clean_nfl$Yds > 1500 & final_clean_nfl$Yds < 1600, final_clean_nfl$Player, ''), vjust = -1) + 
  annotate("text", label = "Median Yards", x = (median(final_clean_nfl$Yds) - 10), y = 22500000, color = "grey")
```

There is no clear trend between the yards travelled with the ball and a player's salary in 2024. Some of the players receiving the highest salaries are travelling more than the median number of yards, but some are very close to or below the median. That being said, the players travelling some of the greatest distances are not receiving very high salaries.

The two players who travelled the greatest number of yards with the ball did not have very high salaries, and the players receiving the highest salaries were usually above the median yards travelled, with one exception, but were still not travelling particularly exceptional distances.

The median was represented rather than the mean because the yards variable is skewed and appears to have outliers.

#### Plot 3: Bar charts of Salary for top and bottom 10 touchdowns and yards. 

##### Touchdowns: 

Used this link <https://stackoverflow.com/questions/11857935/plot-the-average-values-for-each-level> to understand how to plot the average salary within each number of touchdowns on a geom_bar plot.

```{r}
# sorting the dataset by the number of touchdowns. 
library(dplyr)
sorted_TD_nfl <- final_clean_nfl %>%
  arrange(desc(TD))

# creating new datasets of the top and bottom 10 number of touchdowns. 
bottom10_TD_nfl <- tail(sorted_TD_nfl, 10)
top10_TD_nfl <- head(sorted_TD_nfl, 10)

# plotting bar chart of salaries for the players who made the 10 least touchdowns. 
ggplot(bottom10_TD_nfl, aes(x = factor(TD), y = Salary)) +
  geom_bar(stat = "summary", fun = "mean", fill='#D55E00') +
  labs(title = "Average 2024 Salary by Touchdowns", x = "Touchdowns", y = "2024 Salary ($)") + 
  theme_minimal()

# and 10 most touchdowns. 
ggplot(top10_TD_nfl, aes(x = factor(TD), y = Salary)) +
  geom_bar(stat = "summary", fun = "mean", fill='#D55E00') +
  labs(title = "Average 2024 Salary by Touchdowns", x = "Touchdowns", y = "2024 Salary ($)") + 
  theme_minimal()
```

NOTE: not really sure how useful these graphs are, because we don't really get much from touchdowns for this, because they are whole numbers so multiple people have the same number so we don't really get much.

Instead tried just plotting average salary for each number of touchdowns so we can see everything at once. I think this would be a bit more useful.

```{r}
# sorting the dataset by the number of touchdowns. 
library(dplyr)
sorted_TD_nfl <- final_clean_nfl %>%
  arrange(desc(TD))

# plotting
ggplot(sorted_TD_nfl, aes(x = factor(TD), y = Salary)) +
  geom_bar(stat = "summary", fun = "mean", fill='#D55E00') +
  labs(title = "Average 2024 Salary by Touchdowns", x = "Touchdowns", y = "2024 Salary ($)") + 
  theme_minimal()
```

Can say from this that players making 10, 11, or 13 touchdowns tend to have a higher average salary than the other numbers of touchdowns. Making 13 touchdowns tends to result in the highest average salary, though this is because there was only one player in this category who happens to have a significant salary. Interestingly, making 17 touchdowns, the highest amount, resulted in a very low salary.
